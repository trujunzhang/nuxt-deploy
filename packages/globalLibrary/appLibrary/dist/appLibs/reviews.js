"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Reviews = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _tools = require("@app/tools");

var Types = _interopRequireWildcard(require("@app/types"));

var _photos = require("./photos");

var Reviews = /*#__PURE__*/function () {
  function Reviews() {
    (0, _classCallCheck2["default"])(this, Reviews);
  }

  (0, _createClass2["default"])(Reviews, null, [{
    key: "getHtmlBody",
    value: function getHtmlBody(review) {
      var html = review.body;

      if (html) {
        html = '<p>' + html.replace('\n' + '\n', '</p><p>') + '</p>';
      }

      var htmlBody = {
        __html: html
      };
      return htmlBody;
    }
  }, {
    key: "toDateString",
    value: function toDateString(date) {
      return _tools.MomentUtils.toDateString(date, Reviews.config.dateFormat);
    }
  }, {
    key: "getThumbnailUrlByReviewType",
    value: function getThumbnailUrlByReviewType(review) {
      var objectSchemaName = Types.AppConstants.realmObjects[review.reviewType].objectSchemaName;

      switch (objectSchemaName) {
        case Types.model.PARSE_RESTAURANTS:
          return _photos.Photos.getListThumbnailUrl(review.restaurant);

        case Types.model.PARSE_EVENTS:
          return _photos.Photos.getListThumbnailUrl(review.event.restaurant);

        case Types.model.PARSE_RECIPES:
          return _photos.Photos.getListThumbnailUrl(review.recipe);

        default:
          throw new Error('No matched selected reviewListPageType!');
      }
    }
  }, {
    key: "getCurrentSortArray",
    value: function getCurrentSortArray(reviewListPageType) {
      switch (reviewListPageType) {
        case Types.reviewListPage.REVIEW_LIST_TYPE_NORMAL:
          return [{
            title: 'Normal Sort',
            queryTag: Types.common.REVIEW_SORT_NORMAL
          }, {
            title: 'Newest First',
            queryTag: Types.common.REVIEW_SORT_NEWEST
          }, {
            title: 'Oldest First',
            queryTag: Types.common.REVIEW_SORT_OLDEST
          }, {
            title: 'Highest Rated',
            queryTag: Types.common.REVIEW_SORT_HIGHEST
          }, {
            title: 'Lowest Rated',
            queryTag: Types.common.REVIEW_SORT_LOWEST
          }];

        case Types.reviewListPage.REVIEW_LIST_TYPE_USER_PROFILE_ABOUT:
          return [{
            title: 'Normal Sort',
            queryTag: Types.common.REVIEW_SORT_NORMAL
          }, {
            title: 'Newest First',
            queryTag: Types.common.REVIEW_SORT_NEWEST
          }, {
            title: 'Oldest First',
            queryTag: Types.common.REVIEW_SORT_OLDEST
          }, {
            title: 'Highest Rated',
            queryTag: Types.common.REVIEW_SORT_HIGHEST
          }, {
            title: 'Lowest Rated',
            queryTag: Types.common.REVIEW_SORT_LOWEST
          }];

        default:
          throw new Error('No matched selected reviewListPageType!');
      }
    }
  }, {
    key: "checkCanEditReview",
    value: function checkCanEditReview(_ref) {
      var review = _ref.review,
          currentUser = _ref.currentUser;
      var creator = review.creator;

      if (!!currentUser && !!currentUser.uniqueId && !!creator && !!creator.uniqueId && creator.uniqueId === currentUser.uniqueId) {
        return true;
      }

      return false;
    }
  }, {
    key: "canShowPage",
    value: function canShowPage(_ref2) {
      var forObject = _ref2.forObject,
          pageForm = _ref2.pageForm,
          review = _ref2.review;

      switch (pageForm) {
        case Types.editModel.MODEL_FORM_TYPE_EDIT:
          if (!!forObject && !!review) {
            return true;
          }

          break;

        case Types.editModel.MODEL_FORM_TYPE_NEW:
          if (!!forObject) {
            return true;
          }

          break;
      }

      return false;
    }
  }]);
  return Reviews;
}();

exports.Reviews = Reviews;
Reviews.config = {
  paginationCountPerPage: 2,
  // 6/11/2017
  dateFormat: 'DD/MM/YYYY',
  defaultSortTag: Types.StatusConstants.reviewDefaultSortTag
};
Reviews.RATE_STAR_LABELS = ['Select your rating.', 'Eek! Methinks not.', "Meh. I've experienced better.", 'A-OK.', "Yay! I'm a fan.", 'Woohoo! As good as it gets!'];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcHBMaWJzL3Jldmlld3MudHMiXSwibmFtZXMiOlsiUmV2aWV3cyIsInJldmlldyIsImh0bWwiLCJib2R5IiwicmVwbGFjZSIsImh0bWxCb2R5IiwiX19odG1sIiwiZGF0ZSIsIk1vbWVudFV0aWxzIiwidG9EYXRlU3RyaW5nIiwiY29uZmlnIiwiZGF0ZUZvcm1hdCIsIm9iamVjdFNjaGVtYU5hbWUiLCJBcHBDb25zdGFudHMiLCJyZWFsbU9iamVjdHMiLCJyZXZpZXdUeXBlIiwiVHlwZXMiLCJtb2RlbCIsIlBBUlNFX1JFU1RBVVJBTlRTIiwiUGhvdG9zIiwiZ2V0TGlzdFRodW1ibmFpbFVybCIsInJlc3RhdXJhbnQiLCJQQVJTRV9FVkVOVFMiLCJldmVudCIsIlBBUlNFX1JFQ0lQRVMiLCJyZWNpcGUiLCJFcnJvciIsInJldmlld0xpc3RQYWdlVHlwZSIsInJldmlld0xpc3RQYWdlIiwiUkVWSUVXX0xJU1RfVFlQRV9OT1JNQUwiLCJ0aXRsZSIsInF1ZXJ5VGFnIiwiY29tbW9uIiwiUkVWSUVXX1NPUlRfTk9STUFMIiwiUkVWSUVXX1NPUlRfTkVXRVNUIiwiUkVWSUVXX1NPUlRfT0xERVNUIiwiUkVWSUVXX1NPUlRfSElHSEVTVCIsIlJFVklFV19TT1JUX0xPV0VTVCIsIlJFVklFV19MSVNUX1RZUEVfVVNFUl9QUk9GSUxFX0FCT1VUIiwiY3VycmVudFVzZXIiLCJjcmVhdG9yIiwidW5pcXVlSWQiLCJmb3JPYmplY3QiLCJwYWdlRm9ybSIsImVkaXRNb2RlbCIsIk1PREVMX0ZPUk1fVFlQRV9FRElUIiwiTU9ERUxfRk9STV9UWVBFX05FVyIsInBhZ2luYXRpb25Db3VudFBlclBhZ2UiLCJkZWZhdWx0U29ydFRhZyIsIlN0YXR1c0NvbnN0YW50cyIsInJldmlld0RlZmF1bHRTb3J0VGFnIiwiUkFURV9TVEFSX0xBQkVMUyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0lBTWFBLE87Ozs7Ozs7Z0NB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SWRxQyxFQUFBQSxjQUFjLEVBQUVDLHNCQUFnQkM7QUFKbEIsQztBQURMbEQsTyxDQVFKbUQsZ0IsR0FBbUIsQ0FDeEIscUJBRHdCLEVBRXhCLG9CQUZ3QixFQUd4QiwrQkFId0IsRUFJeEIsT0FKd0IsRUFLeEIsaUJBTHdCLEVBTXhCLDZCQU53QixDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTW9tZW50VXRpbHMgfSBmcm9tICdAYXBwL3Rvb2xzJ1xuaW1wb3J0IHsgQXBwQ29uc3RhbnRzIH0gZnJvbSAnQGFwcC90eXBlcydcbmltcG9ydCB7IFBob3RvcyB9IGZyb20gJy4vcGhvdG9zJ1xuXG5pbXBvcnQgeyBTdGF0dXNDb25zdGFudHMgfSBmcm9tICdAYXBwL3R5cGVzJ1xuXG5pbXBvcnQgKiBhcyBUeXBlcyBmcm9tICdAYXBwL3R5cGVzJ1xuXG5leHBvcnQgY2xhc3MgUmV2aWV3cyB7XG4gIHN0YXRpYyBjb25maWcgPSB7XG4gICAgcGFnaW5hdGlvbkNvdW50UGVyUGFnZTogMixcbiAgICAvLyA2LzExLzIwMTdcbiAgICBkYXRlRm9ybWF0OiAnREQvTU0vWVlZWScsXG4gICAgZGVmYXVsdFNvcnRUYWc6IFN0YXR1c0NvbnN0YW50cy5yZXZpZXdEZWZhdWx0U29ydFRhZ1xuICB9XG5cbiAgc3RhdGljIFJBVEVfU1RBUl9MQUJFTFMgPSBbXG4gICAgJ1NlbGVjdCB5b3VyIHJhdGluZy4nLFxuICAgICdFZWshIE1ldGhpbmtzIG5vdC4nLFxuICAgIFwiTWVoLiBJJ3ZlIGV4cGVyaWVuY2VkIGJldHRlci5cIixcbiAgICAnQS1PSy4nLFxuICAgIFwiWWF5ISBJJ20gYSBmYW4uXCIsXG4gICAgJ1dvb2hvbyEgQXMgZ29vZCBhcyBpdCBnZXRzISdcbiAgXVxuXG4gIHN0YXRpYyBnZXRIdG1sQm9keShyZXZpZXcpIHtcbiAgICBsZXQgaHRtbCA9IHJldmlldy5ib2R5XG4gICAgaWYgKGh0bWwpIHtcbiAgICAgIGh0bWwgPSAnPHA+JyArIGh0bWwucmVwbGFjZSgnXFxuJyArICdcXG4nLCAnPC9wPjxwPicpICsgJzwvcD4nXG4gICAgfVxuICAgIGNvbnN0IGh0bWxCb2R5ID0ge1xuICAgICAgX19odG1sOiBodG1sXG4gICAgfVxuICAgIHJldHVybiBodG1sQm9keVxuICB9XG5cbiAgc3RhdGljIHRvRGF0ZVN0cmluZyhkYXRlKSB7XG4gICAgcmV0dXJuIE1vbWVudFV0aWxzLnRvRGF0ZVN0cmluZyhkYXRlLCBSZXZpZXdzLmNvbmZpZy5kYXRlRm9ybWF0KVxuICB9XG5cbiAgc3RhdGljIGdldFRodW1ibmFpbFVybEJ5UmV2aWV3VHlwZShyZXZpZXcpIHtcbiAgICBjb25zdCB7IG9iamVjdFNjaGVtYU5hbWUgfSA9IEFwcENvbnN0YW50cy5yZWFsbU9iamVjdHNbcmV2aWV3LnJldmlld1R5cGVdXG4gICAgc3dpdGNoIChvYmplY3RTY2hlbWFOYW1lKSB7XG4gICAgICBjYXNlIFR5cGVzLm1vZGVsLlBBUlNFX1JFU1RBVVJBTlRTOlxuICAgICAgICByZXR1cm4gUGhvdG9zLmdldExpc3RUaHVtYm5haWxVcmwocmV2aWV3LnJlc3RhdXJhbnQpXG4gICAgICBjYXNlIFR5cGVzLm1vZGVsLlBBUlNFX0VWRU5UUzpcbiAgICAgICAgcmV0dXJuIFBob3Rvcy5nZXRMaXN0VGh1bWJuYWlsVXJsKHJldmlldy5ldmVudC5yZXN0YXVyYW50KVxuICAgICAgY2FzZSBUeXBlcy5tb2RlbC5QQVJTRV9SRUNJUEVTOlxuICAgICAgICByZXR1cm4gUGhvdG9zLmdldExpc3RUaHVtYm5haWxVcmwocmV2aWV3LnJlY2lwZSlcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gbWF0Y2hlZCBzZWxlY3RlZCByZXZpZXdMaXN0UGFnZVR5cGUhJylcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZ2V0Q3VycmVudFNvcnRBcnJheShyZXZpZXdMaXN0UGFnZVR5cGU6IHN0cmluZyk6IElSZXZpZXdTb3J0SXRlbVtdIHtcbiAgICBzd2l0Y2ggKHJldmlld0xpc3RQYWdlVHlwZSkge1xuICAgICAgY2FzZSBUeXBlcy5yZXZpZXdMaXN0UGFnZS5SRVZJRVdfTElTVF9UWVBFX05PUk1BTDpcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZTogJ05vcm1hbCBTb3J0JyxcbiAgICAgICAgICAgIHF1ZXJ5VGFnOiBUeXBlcy5jb21tb24uUkVWSUVXX1NPUlRfTk9STUFMXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZTogJ05ld2VzdCBGaXJzdCcsXG4gICAgICAgICAgICBxdWVyeVRhZzogVHlwZXMuY29tbW9uLlJFVklFV19TT1JUX05FV0VTVFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGl0bGU6ICdPbGRlc3QgRmlyc3QnLFxuICAgICAgICAgICAgcXVlcnlUYWc6IFR5cGVzLmNvbW1vbi5SRVZJRVdfU09SVF9PTERFU1RcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnSGlnaGVzdCBSYXRlZCcsXG4gICAgICAgICAgICBxdWVyeVRhZzogVHlwZXMuY29tbW9uLlJFVklFV19TT1JUX0hJR0hFU1RcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnTG93ZXN0IFJhdGVkJyxcbiAgICAgICAgICAgIHF1ZXJ5VGFnOiBUeXBlcy5jb21tb24uUkVWSUVXX1NPUlRfTE9XRVNUXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICBjYXNlIFR5cGVzLnJldmlld0xpc3RQYWdlLlJFVklFV19MSVNUX1RZUEVfVVNFUl9QUk9GSUxFX0FCT1VUOlxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnTm9ybWFsIFNvcnQnLFxuICAgICAgICAgICAgcXVlcnlUYWc6IFR5cGVzLmNvbW1vbi5SRVZJRVdfU09SVF9OT1JNQUxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHRpdGxlOiAnTmV3ZXN0IEZpcnN0JyxcbiAgICAgICAgICAgIHF1ZXJ5VGFnOiBUeXBlcy5jb21tb24uUkVWSUVXX1NPUlRfTkVXRVNUXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICB0aXRsZTogJ09sZGVzdCBGaXJzdCcsXG4gICAgICAgICAgICBxdWVyeVRhZzogVHlwZXMuY29tbW9uLlJFVklFV19TT1JUX09MREVTVFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGl0bGU6ICdIaWdoZXN0IFJhdGVkJyxcbiAgICAgICAgICAgIHF1ZXJ5VGFnOiBUeXBlcy5jb21tb24uUkVWSUVXX1NPUlRfSElHSEVTVFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgdGl0bGU6ICdMb3dlc3QgUmF0ZWQnLFxuICAgICAgICAgICAgcXVlcnlUYWc6IFR5cGVzLmNvbW1vbi5SRVZJRVdfU09SVF9MT1dFU1RcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTm8gbWF0Y2hlZCBzZWxlY3RlZCByZXZpZXdMaXN0UGFnZVR5cGUhJylcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgY2hlY2tDYW5FZGl0UmV2aWV3KHsgcmV2aWV3LCBjdXJyZW50VXNlciB9KSB7XG4gICAgY29uc3QgeyBjcmVhdG9yIH0gPSByZXZpZXdcbiAgICBpZiAoXG4gICAgICAhIWN1cnJlbnRVc2VyICYmXG4gICAgICAhIWN1cnJlbnRVc2VyLnVuaXF1ZUlkICYmXG4gICAgICAhIWNyZWF0b3IgJiZcbiAgICAgICEhY3JlYXRvci51bmlxdWVJZCAmJlxuICAgICAgY3JlYXRvci51bmlxdWVJZCA9PT0gY3VycmVudFVzZXIudW5pcXVlSWRcbiAgICApIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgc3RhdGljIGNhblNob3dQYWdlKHsgZm9yT2JqZWN0LCBwYWdlRm9ybSwgcmV2aWV3IH0pIHtcbiAgICBzd2l0Y2ggKHBhZ2VGb3JtKSB7XG4gICAgICBjYXNlIFR5cGVzLmVkaXRNb2RlbC5NT0RFTF9GT1JNX1RZUEVfRURJVDpcbiAgICAgICAgaWYgKCEhZm9yT2JqZWN0ICYmICEhcmV2aWV3KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBUeXBlcy5lZGl0TW9kZWwuTU9ERUxfRk9STV9UWVBFX05FVzpcbiAgICAgICAgaWYgKCEhZm9yT2JqZWN0KSB7XG4gICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgfVxuICAgICAgICBicmVha1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufVxuIl19